<div class="incomes-container fade-in">
  <div class="list-header">
    <div class="header-left">
      <button class="btn-back" routerLink="/dashboard">
        <i class="bi bi-arrow-left"></i> Dashboard
      </button>
      <h1>
        <i class="bi bi-cash-stack"></i> Mis Ingresos
      </h1>
    </div>
    <button class="btn btn-success" routerLink="/create-income">
      <i class="bi bi-plus-circle"></i> Nuevo Ingreso
    </button>
  </div>

  <div class="filters-section">
    <label>Ordenar por:</label>
    <div class="filters-buttons">
      <button 
        class="filter-btn" 
        [class.active]="sortBy() === 'default'"
        (click)="changeSortBy('default')">
        <i class="bi bi-list-ul"></i> Por Defecto
      </button>
      <button 
        class="filter-btn" 
        [class.active]="sortBy() === 'amount'"
        (click)="changeSortBy('amount')">
        <i class="bi bi-cash"></i> Por Cantidad
      </button>
      <button 
        class="filter-btn" 
        [class.active]="sortBy() === 'date'"
        (click)="changeSortBy('date')">
        <i class="bi bi-calendar"></i> Por Fecha
      </button>
    </div>
  </div>

  <div *ngIf="incomes().length; else noIncomes" class="incomes-grid">
    @for (income of incomes(); track $index) {
      <div class="income-card">
        <div class="income-header">
          <div>
            <span class="income-label">{{ income.source }}</span>
            <h3>{{ income.description }}</h3>
          </div>
          <span class="income-badge">${{ income.amount }}</span>
        </div>
        <div class="income-footer">
          <span class="income-date">
            <i class="bi bi-calendar"></i> {{ income.date | date:'dd/MM/yyyy' }}
          </span>
          <button class="btn-delete" (click)="deleteIncome(income.id)">
            <i class="bi bi-trash"></i>
          </button>
        </div>
      </div>
    }
  </div>
  
  <ng-template #noIncomes>
    <div class="empty-state">
      <i class="bi bi-inbox"></i>
      <h3>No hay ingresos registrados</h3>
      <p>Comienza añadiendo tu primer ingreso</p>
      <button class="btn btn-success" routerLink="/create-income">
        <i class="bi bi-plus-circle"></i> Crear Ingreso
      </button>
    </div>
  </ng-template>

  <div *ngIf="successMessage()" class="alert alert-success">
    {{ successMessage() }}
  </div>
  
  <div *ngIf="errorMessage()" class="alert alert-danger">
    {{ errorMessage() }}
  </div>

  <app-confirm-dialog
    [isOpen]="showConfirmDialog()"
    title="Eliminar Ingreso"
    message="¿Estás seguro de que deseas eliminar este ingreso? Esta acción no se puede deshacer."
    confirmText="Eliminar"
    cancelText="Cancelar"
    type="danger"
    (confirm)="confirmDeleteIncome()"
    (cancel)="cancelDeleteIncome()">
  </app-confirm-dialog>
</div>